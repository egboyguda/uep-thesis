<% layout('layouts/sidebar')%> 
<link rel="stylesheet" href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.7.1/css/buttons.dataTables.min.css">


<div class='row'>
    <div class="col-6 offset-3">
        <div class="mb-3">
            <label for="regions" class="form-label">Destination</label>
                        <select name="destination" id="regions" class="form-select">
                            <option selected>Open this select menu</option>
                            <% for(barangay of barangays) {%>
                                <option value="<%= barangay.name%> "><%=barangay.name%>  </option>
                                <% } %>  
                        </select>
        </div>
        <input type="button" value="Find" class="btn btn-success" onClick='getData()'>
         <!-- Button trigger modal -->
<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
    Launch demo modal
  </button>
  
  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          ...
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Save changes</button>
        </div>
      </div>
    </div>
  </div>
</div>


<table id="example" class="display" style="width:100%">
    <thead>
	    <tr>
            <th>name</th>
            <th>barangay</th>
            <th>Edit</th>
         
	    </tr>
    </thead>
   
    </table>
 
</div>    
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.7.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.7.1/js/buttons.html5.min.js"></script>
<script>
    async function getData(){
        await $('#example').DataTable().clear().destroy();
        var barangay = document.getElementById('regions').value;
        axios.get(`/staff/household/${barangay}`)
        .then((res)=>{
            console.log(res.data)
            $("#example").DataTable({
                
    				data:res.data,
                    dom:'Bfrtip',
    				"columns":[
    					{"data":"name"},
    					{"data":"barangay"},
    					
                        {
                            "data":null,
                            "bSortable": false,
                            "mRender": function (o) { return '<a href=/barangay/success/' + o._id + '>' + 'Edit' + '</a>'; }
                        }
            
    				],
                    
                    
                    buttons: [
            {
                extend: 'pdfHtml5', 
                exportOptions: {
                    columns: [ 0, 1 ]
                },
                download: 'open',

               customize: function ( doc ) {
doc.content[1].table.widths = [
'50%',
'50%',
'50%',
'50%',
'10%',
'10%',
'5%'
]
}
            }
        ]


    			 });
        })
    }
</script>